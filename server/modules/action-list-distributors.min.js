var r=require("rethinkdb");
module.exports=function(e,f,c,g,a){var b=0,h=100;c=["smart","name","id"];var d="smart",l=["ascending","descending"],k="ascending";"number"==typeof a.after&&(b=a.after);"number"==typeof a.count&&0<=a.count&&1001>a.count&&(h=a.count);"string"===typeof a.order&&a.order in c&&(d=c[a.order]);"string"===typeof a.direction&&a.direction in l&&(k=a.direction);"descending"==k&&(d=r.desc(d));r.table("Distributors").count().run(f,function(a,c){a||(0>b&&(b+=c),b=Math.max(0,b),r.table("Distributors").orderBy(d).slice(b,b+
h).merge(function(a){return{collets:r.table("Collators").getAll(r.args(a("collators"))).merge(function(a){return{filtrets:r.table("Filters").getAll(r.args(a("filters"))).coerceTo("array")}}).coerceTo("array")}}).coerceTo("array").run(f,function(a,b){a?(g.send({err:"Unable to query."}),e&&console.log(a)):(g.send({distributors:b}),e&&console.log("Queried distributors."),e&&console.log(b))}))})};
